***A Three-Dimensional Cartesian Mesh Generation Algorithm Based on the GPU Parallel Ray Casting Method***
**一种基于GPU并行射线投射法的三维笛卡尔网格生成算法**

#### *Abstract*

大规模场景下鲁棒高效的笛卡尔网格生成对于**流体动力学仿真**和**碰撞检测**具有重要意义。高质量大规模的网格生成任务在个人计算机上是很难实现的。本文提出了一种基于GPU的并行笛卡尔网格生成算法。该算法在计算机图形学中的传统射线投射方法的基础上进行了优化，对于大规模笛卡尔网格生成更高效、更稳定。在网格生成过程中，由三角形面表示的几何体被转换为由正六面体组成的网格。提出了一种并行射线生成方法，以减少主机内存和设备内存之间的数据交换。采用基于栅格的并行基元搜索方法，搜索三角形面，用于射线和三角形的交点计算。利用CUDA库实现了并行笛卡尔网格生成算法。与传统的串行算法相比，并行笛卡尔网格生成算法的性能有了很大提高，这在不同的数值实验中得到了证明。通过一些测试，分析了并行算法的性能，结果表明GPU的并行计算能力得到了充分利用。最后，给出了笛卡尔网格生成的例子。

#### *Keywords*

网格生成、GPU并行计算、计算几何、数值仿真。

#### *Introduction*

笛卡尔网格已被广泛用于计算流体动力学、计算爆炸力学和计算机图形学，如碰撞检测。笛卡尔网格通常用作三维几何体的近似离散化。如图1所示，这种数值网格由多个正六面体堆砌而成，属于不同物质的网格边界呈梯形。在图1中，二维计算域中有两种物质，分别用蓝色和白色表示，包含椭圆的计算域被网格化到笛卡尔网格中。在计算流体动力学应用中，几何边界条件离散到笛卡尔网格中，物理量分配到网格单元上。单元上的物理量的值将随着计算过程而更新，并将其视为连续物理空间中物理量的近似值。在计算机图形应用中，笛卡尔网格生成过程与体素化类似，体素化可用于三维游戏中的渲染场景。在计算机游戏领域，关于体素化的研究多种多样。本文提出的算法重点是在流体力学、爆炸力学和电磁数值模拟中的应用。在这些领域中，生成的网格单元数量远大于三维电脑游戏中的单元网格数量，通常可以达到10^10^个。虽然实时性不是必需的，但是网格的生成效率对数值仿真的效率有很大影响，因此高效的笛卡尔网格生成需要引起重视。

<div align=center><img width="400" src="/figure1.png"></div> 
