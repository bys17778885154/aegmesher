***A Three-Dimensional Cartesian Mesh Generation Algorithm Based on the GPU Parallel Ray Casting Method***
**一种基于GPU并行射线投射法的三维笛卡尔网格生成算法**

#### *Abstract*

大规模场景下鲁棒高效的笛卡尔网格生成对于**流体动力学仿真**和**碰撞检测**具有重要意义。高质量大规模的网格生成任务在个人计算机上是很难实现的。本文提出了一种基于GPU的并行笛卡尔网格生成算法。该算法在计算机图形学中的传统射线投射方法的基础上进行了优化，对于大规模笛卡尔网格生成更高效、更稳定。在网格生成过程中，由三角形面表示的几何体被转换为由正六面体组成的网格。提出了一种并行射线生成方法，以减少主机内存和设备内存之间的数据交换。采用基于栅格的并行基元搜索方法，搜索三角形面，用于射线和三角形的交点计算。利用CUDA库实现了并行笛卡尔网格生成算法。与传统的串行算法相比，并行笛卡尔网格生成算法的性能有了很大提高，这在不同的数值实验中得到了证明。通过一些测试，分析了并行算法的性能，结果表明GPU的并行计算能力得到了充分利用。最后，给出了笛卡尔网格生成的例子。

#### *Keywords*

网格生成、GPU并行计算、计算几何、数值仿真。

#### *Introduction*

笛卡尔网格已被广泛用于计算流体动力学、计算爆炸力学和计算机图形学，如碰撞检测。笛卡尔网格通常用作三维几何体的近似离散化。如图1所示，这种数值网格由多个正六面体堆砌而成，属于不同物质的网格边界呈梯形。在图1中，二维计算域中有两种物质，分别用蓝色和白色表示，包含椭圆的计算域被网格化到笛卡尔网格中。在计算流体动力学应用中，几何边界条件离散到笛卡尔网格中，物理量分配到网格单元上。单元上的物理量的值将随着计算过程而更新，并将其视为连续物理空间中物理量的近似值。在计算机图形应用中，笛卡尔网格生成过程与体素化类似，体素化可用于三维游戏中的渲染场景。在计算机游戏领域，关于体素化的研究多种多样。本文提出的算法重点是在流体力学、爆炸力学和电磁数值模拟中的应用。在这些领域中，生成的网格单元数量远大于三维电脑游戏中的单元网格数量，通常可以达到10^10^个。虽然实时性不是必需的，但是网格的生成效率对数值模拟的效率有很大影响，因此高效的笛卡尔网格生成需要引起重视。

<div align=center><img width="400" src="/applsci-10-00058-g001.jpg"></div> 

大规模笛卡尔网格生成有两种流行的算法。一种是射线投射算法，创建一系列射线，并计算射线和几何体的交点。该方法由于其流程清晰、简单，通常被应用于大规模网格生成中。然而，由于几何交点计算耗时巨大，此算法效率有待提高。另一种是切片算法，指的是快速原型加工的思想，使用一系列平行平面切割几何体，以获得每个平面中的轮廓。然后，三维空间中的笛卡尔网格生成任务就转换成了二维平面中的类似任务了。该方法可以在网格生成过程中获得更多的几何信息。然而，拓扑重建的过程必须添加到切片算法中，这会导致效率下降。此外，还必须添加一个预处理程序，这使算法过于繁琐以致于算法的鲁棒性和适应性都有待提高，并且网格生成过程不利于大规模并行。考虑到在大规模复杂场景下的三维笛卡尔网格生成中的大量网格单元，*MacGillivary*采用高精度射线-面交点测试和基于传统射线投射算法的高效数据存储方法，实现了万亿笛卡尔网格单元的生成。但是这一成果在效率和适应性上仍有一些细节有待提高，他们的算法是一种串行算法。

对于大规模场景，时间消耗是笛卡尔网格生成的最大限制。GPU并行计算或许是突破性能瓶颈的最佳选择。*Park*和*Shin*提出了一种基于GPU的三维自适应笛卡尔网格生成方法。*Schwarz*和*Seidel*提出了一种基于GPU的快速并行表面和实体体素化，可以实时将几何体离散为二进制体素。他们的算法使用八叉树作为离散结果，可以有效地用于碰撞检测应用。然而，网格单元的数量太小，无法用于流体动力学的数值模拟。*Cohenor*和*Pantaleoni*实现了类似工作。在网格生成过程中，大部分的工作集中在射线和面间的交点计算上。因此，快速面搜索方法是一个关键点。K维树和包围盒层次树通常用于搜索三维动态场景下的几何基元。*Shevtsov*等人提出了一种使用并行KD树渲染场景的并行射线跟踪算法。*Wehr*和*Radkowski*引入了一种GPU上三维点的并行KD树构造方法，该方法采用排序算法在构造过程中保持高并行度。*Lauterbach*和*Ganestam*实现了在GPU上并行构建BVH树用于场景渲染。在本文的笛卡尔网格生成算法中，在二维投影平面上进行基元搜索，基元在计算域中的位置不改变。因此，在笛卡尔网格生成中采用了栅格方法。

本文提出了一种基于GPU的并行笛卡尔网格生成算法。在2.2节中，提出了一种GPU上的并行射线生成方法，以减少主机内存和设备内存之间的数据交换。在2.3节中，采用基于栅格的基元搜索方法搜索三角形面用于射线和三角形的交点计算。笛卡尔网格生成的一些示例见3.1节。并行算法和传统算法的性能分析和比较见3.2节。
